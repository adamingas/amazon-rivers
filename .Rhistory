rep(2,10)
?character
as.character(23)
as.character("eleison")
load("faraway)
exit
pop_mu			<- 1.4
pop_sig			<- 1
ind_n			<- 30
set.seed(42)
require(data.table)
require(ggplot2)
require(rstan)
require(rethinking)
seq_len(1)
seq_len(14)
seq(14)
ind_pars		<- data.table(	IND = seq_len(ind_n),
IND_MU = rnorm(ind_n,pop_mu,pop_sig))
ind_pars
head(ind_pars)
#	simulate observations
obs_sig			<- 0.5
tmp				<- 10
df				<- data.table(	IND = seq_len(ind_n),
OBS_N = c(rep(3,tmp),rep(10,tmp),rep(30,tmp)))
df
c(rep(3,tmp),rep(10,tmp),rep(30,tmp))
df				<- merge(df, ind_pars, by='IND')
df				<- merge(df, ind_pars, by='IND')
df				<- merge(df, ind_pars, by='IND')
df
df				<- data.table(	IND = seq_len(ind_n),
OBS_N = c(rep(3,tmp),rep(10,tmp),rep(30,tmp)))
df				<- merge(df, ind_pars, by='IND')
df
do				<- df[, list(	OBS_ID = seq_len(OBS_N),
OBS = rnorm(OBS_N, IND_MU, obs_sig)), by='IND']
do
df
#	make unpooled estimate of MU, and keep record of this
tmp				<- do[, list(	MU_EST_UNPOOLED = mean(OBS)	), by='IND']
tmp
df[, list(	OBS_ID = seq_len(OBS_N)]
df[, list(	OBS_ID = seq_len(OBS_N))]
df
do
df[,list(OBS_ID = seq_len(OBS_N)),by="IND"]
df[,(OBS_ID = seq_len(OBS_N)),by="IND"]
df[,.(OBS_ID = seq_len(OBS_N)),by="IND"]
df
df[,list(OBS_ID = seq_len(OBS_N),IND_MU),by="IND"]
?read.csv
?matrix
install.packages(‘bartMachine’)
install.packages("bartMachine")
install.packages("rJava")
install.packages("rJava")
install.packages("bartMachine")
#setwd("~/")
setwd("~/Documents/Stats/Project/amazon-rivers/")
library(vegan)
library(ape)
library(dplyr)
library(ggplot2)
library(magrittr)
library(cluster)
library(metagenomeSeq)
library(caret)
library(MASS)
library(corrplot)
library(mvabund)
library(bartMachine)
wwf =read.table(file = "WWF_Samples.txt",header =TRUE,sep = "\t",stringsAsFactors = FALSE)
otudata = read.table(file = "WWF_Peru_for_BenCalderhead.csv",sep = ",",stringsAsFactors = FALSE)
otutable<- t(otudata)[-seq(1,8),]
colnames(otutable) <- c("ID",t(otudata)[1,-1])
otudf <- as.data.frame(x=otutable[,-1],stringsAsFactors=FALSE,row.names = otutable[,1])
#otudf$ID <- as.character(otudf$ID)
otudf[,]<- sapply(otudf[,], as.numeric)
otumatrix <-as.matrix( t(otudf))
wwfdf <- as.data.frame(x=wwf)
wwfdf$Area_group %<>% as.numeric %>% as.factor
wwfdf[,"Area_group_name"] <- sapply(wwfdf[,"Area_group_name"],as.factor)
wwfdf$Water %<>% as.factor
wwfdf$ID_nosamples <- gsub(pattern = "[a-zA-Z-]","",wwfdf$ID)
wwfdf$ID_nosamples %<>% as.factor
#write.csv(wwfdf,file="wwfdf")
#write.csv(otudf,file = "otudf")
plotfun <- function(data,axis1,axis2){
mergeddata  <-merge(data,wwfdf[,c("ID","Area_group","Area_group_name","Water")],by.x=0,by.y="ID")
return( ggplot(mergeddata,aes_string(axis1,axis2,shape = "Water"),size = 2)
#geom_point(aes(color=Water),size=2)
+ geom_point(aes(fill = Area_group_name),size=3)
+ geom_point(aes(color = Area_group_name),size=2)
+scale_colour_brewer(palette = "Accent")
)}
wwfdf$Water
######
# BART #
########
bartMachine(X = otudf,y=wwfdf$Water)
######
# BART #
########
# train test stratified split
trainIndx <- createDataPartition(wwfdf$Area_group,times =7,p = 0.7)
for i in trainIndx
for (i in trainIndx)
for (i in trainIndx){
print(i)
}
bm<- bartMachine(X = otudf,y=wwfdf$Water)
bm
bart_predict_for_test_data(bm,otudf,wwfdf$Water)
bart_predict_for_test_data(bm,otudf,wwfdf$Water)== wwfdf$Water
bart_predict_for_test_data(bm,otudf,wwfdf$Water)$yhat== wwfdf$Water
bart_predict_for_test_data(bm,otudf,wwfdf$Water)$yhat
bart_predict_for_test_data(bm,otudf,wwfdf$Water)
bart_predict_for_test_data(bm,otudf,wwfdf$Water)$y_hat
bart_predict_for_test_data(bm,otudf,wwfdf$Water)$y_hat ==wwfdf$Water
for (i in trainIndx){
bartmodel = bartMachine(X=otudf[i,],y=wwfdf$Water[i])
predbart <-bart_predict_for_test_data(bartmodel,otudf[-i,],wwfdf$Water[-i])
print(mean(predbart$y_hat ==wwfdf$Water[-i]))
}
for (i in trainIndx){
bartmodel = bartMachine(X=otudf[i,],y=wwfdf$Water[i],verbose = F)
predbart <-bart_predict_for_test_data(bartmodel,otudf[-i,],wwfdf$Water[-i])
print(mean(predbart$y_hat ==wwfdf$Water[-i]))
}
######
# BART #
########
# train test stratified split
trainIndx <- createDataPartition(wwfdf$Area_group,times =7,p = 0.8)
for (i in trainIndx){
bartmodel = bartMachine(X=otudf[i,],y=wwfdf$Water[i],verbose = F)
predbart <-bart_predict_for_test_data(bartmodel,otudf[-i,],wwfdf$Water[-i])
print(mean(predbart$y_hat ==wwfdf$Water[-i]))
}
